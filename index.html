doc.autoTable({
      head: [['Date', 'Section', 'Description', 'Amount']],
      body: rows,
      startY: 30,
    });

    doc.save('expenses_report.pdf');
  }

  // Initialization on dashboard load
  function initDashboard() {
    showPage('expensesPage');

    loadIncome();
    ['grocery', 'online', 'market'].forEach(section => {
      loadBudget(section);
      renderItems(section);
      updateBalance(section);
    });

    // Set filter date default to today if empty
    const filterDateInput = document.getElementById('filterDate');
    if (!filterDateInput.value) {
      filterDateInput.value = new Date().toISOString().split('T')[0];
    }

    loadExpenses();
  }

  // On page load, check if logged in
  window.onload = () => {
    if (currentUser) {
      document.getElementById('loginPage').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
      initDashboard();
    }
  };
</script>
</body>
</html>
